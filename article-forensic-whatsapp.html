<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forensic WhatsApp : Analyse Avanc√©e - Oumar Ali Mahamat Guedi</title>
    <link rel="stylesheet" href="assets/css/style.css">

</head>

<body>
    <canvas id="matrix-canvas"></canvas>

    <div id="header-placeholder"></div>

    <section class="project-details" style="padding-top: 120px;">
        <div class="container">
            <div class="breadcrumb">
                <a href="index.html">‚Üê Retour au portfolio</a>
            </div>

            <h1 class="section-title" style="text-align: left; margin-bottom: 1rem;">
                Cas Pratique Forensic : L'illusion de la suppression sur WhatsApp (Android Root)
            </h1>
            <p style="color: var(--secondary); font-size: 1.2rem; margin-bottom: 3rem;">
                Par Oumar Ali Mahamat Guedi | Expert Forensique & Cybers√©curit√©
            </p>

            <img src="assets/img/blog/cover_forensic.jpg" alt="Investigation Num√©rique Mobile" class="project-img">

            <div class="article-content">

                <h3>üöÄ Introduction : Le mythe de la donn√©e effac√©e</h3>
                <p>
                    En cybers√©curit√©, nous r√©p√©tons souvent : "Ce qui est sur Internet reste sur Internet". Mais qu'en
                    est-il de ce qui est sur votre t√©l√©phone ? Une croyance tenace persiste chez les utilisateurs : la
                    fonction "Supprimer pour moi" ou "Supprimer pour tous" de WhatsApp effacerait d√©finitivement les
                    preuves. <strong>C'est faux.</strong>
                </p>
                <p>
                    Dans le cadre de mes recherches en forensic mobile, j'ai r√©cemment conduit une analyse approfondie
                    de la derni√®re version de WhatsApp (D√©cembre 2025) sur un environnement Android 16. L'objectif √©tait
                    de confronter la th√©orie √† la r√©alit√© d'un acc√®s privil√©gi√© (Root).
                </p>
                <p>
                    Au travers de l'<strong>"Op√©ration Scorpion"</strong>, une simulation d'enqu√™te men√©e en
                    laboratoire, cet article d√©montre comment un expert forensique peut exhumer un message sensible
                    ("CODE_BUNKER") supprim√© par un suspect, en analysant les traces r√©siduelles des bases de donn√©es
                    SQLite.
                </p>
                <p>
                    <em>Note technique : Pour ceux qui souhaitent reproduire ce laboratoire et apprendre √† rooter leur
                        propre t√©l√©phone pour l'analyse, je recommande de suivre <a
                            href="https://youtu.be/pcwRWBHFAlg?si=MAEi9nQsyKiqM8X0" target="_blank"
                            style="color: var(--primary);">cette excellente vid√©o</a> qui d√©taille la proc√©dure.</em>
                </p>

                <div class="warning-box">
                    <strong>‚ö†Ô∏è Avertissement :</strong> Ce tutoriel est destin√© √† des fins √©ducatives et
                    professionnelles (Forensic, Pentest autoris√©). L'interception de communications priv√©es sans
                    consentement est ill√©gale.
                </div>

                <h3>üïµÔ∏è‚Äç‚ôÇÔ∏è 1. La Sc√®ne de Crime (Simulation)</h3>
                <p>
                    Pour cet audit, j'ai simul√© une conversation criminelle contenant un code sensible :
                    <strong>"CODE_BUNKER_77"</strong>. Quelques secondes apr√®s l'envoi, le suspect supprime le message
                    via l'option "Supprimer pour moi".
                </p>
                <p>
                    Sur l'interface utilisateur, la preuve a disparu, laissant penser √† une impasse pour l'enqu√™teur non
                    sp√©cialis√©.
                </p>

                <img src="assets/img/blog/capture_ecran_0.png" alt="Vue utilisateur WhatsApp message supprim√©"
                    class="project-img">
                <center>
                    <p class="img-caption">Figure 1 : La conversation semble anodine. Le message contenant le code
                        sensible a √©t√© supprim√©.</p>
                </center>

                <h3>‚öôÔ∏è 2. L'Acquisition "Live" (La strat√©gie Root)</h3>
                <p>
                    Sur un t√©l√©phone non root√©, nous sommes forc√©s d'extraire des sauvegardes chiffr√©es (.crypt16) et de
                    tenter de casser le chiffrement. Mais avec le Root, la donne change. WhatsApp doit lire ses messages
                    en clair pour fonctionner. Le fichier de base de donn√©es active se trouve dans la partition syst√®me
                    prot√©g√©e.
                </p>
                <p>
                    Pour cette investigation, une √©l√©vation de privil√®ges a √©t√© n√©cessaire pour contourner la Sandbox
                    d'Android et acc√©der au dossier <code>/data/data/</code>.
                </p>

                <div class="code-block" data-lang="Bash">
                    <span class="code-command">adb shell</span><br>
                    <span class="code-command">su</span><br>
                    <span class="code-comment"># Le prompt passe de $ √† # (indiquant l'acc√®s Root
                        SuperUtilisateur)</span>
                </div>

                <img src="assets/img/blog/capture_ecran_2.png" alt="Terminal ADB Root" class="project-img">
                <center>
                    <p class="img-caption">Figure 2 : Obtention des droits Root (su) via le pont ADB.</p>
                </center>

                <p>
                    Une fois l'acc√®s obtenu, l'erreur classique est de ne copier que le fichier principal
                    <code>msgstore.db</code>. Pour une analyse forensique compl√®te, il est imp√©ratif de s√©curiser le
                    <strong>Trio SQLite</strong> pour garantir l'int√©grit√© des donn√©es volatiles.
                </p>

                <div class="code-block" data-lang="Bash">
                    <span class="code-command">mkdir -p /sdcard/EVIDENCE_SCORPION</span><br>
                    <span class="code-comment"># Copie de la base principale ET des journaux WAL (Crucial !)</span><br>
                    <span class="code-command">cp /data/data/com.whatsapp/databases/msgstore.db
                        /sdcard/EVIDENCE_SCORPION/</span><br>
                    <span class="code-command">cp /data/data/com.whatsapp/databases/msgstore.db-wal
                        /sdcard/EVIDENCE_SCORPION/</span><br>
                    <span class="code-command">cp /data/data/com.whatsapp/databases/msgstore.db-shm
                        /sdcard/EVIDENCE_SCORPION/</span><br>
                    <span class="code-comment"># V√©rification de la taille du fichier WAL</span><br>
                    <span class="code-command">ls -l /sdcard/EVIDENCE_SCORPION/</span>
                </div>

                <img src="assets/img/blog/capture_ecran_3.png" alt="Listing des fichiers extraits" class="project-img">
                <center>
                    <p class="img-caption">Figure 3 : S√©curisation des preuves. Notez la taille du fichier
                        msgstore.db-wal (506 Ko).</p>
                </center>

                <h3>üîç 3. L'Analyse Logique et le "Message Fant√¥me"</h3>
                <p>
                    En ouvrant le fichier principal <code>msgstore.db</code> avec un logiciel d'analyse SQL standard
                    (comme DB Browser), les r√©sultats semblent confirmer la suppression.
                </p>
                <p>
                    La requ√™te SQL ex√©cut√©e sur la table <code>message</code> montre bien l'horodatage de l'√©change,
                    mais le contenu du message cible est marqu√© comme <code>NULL</code> (vide). Le moteur SQL ob√©it √†
                    l'instruction de suppression enregistr√©e dans la base.
                </p>

                <img src="assets/img/blog/capture_ecran_4.png" alt="DB Browser r√©sultat NULL" class="project-img">
                <center>
                    <p class="img-caption">Figure 4 : La requ√™te SQL montre une entr√©e dont le contenu est NULL. Pour un
                        enqu√™teur standard, la preuve n'existe plus.</p>
                </center>

                <h3>üí° 4. La R√©v√©lation (Forensic Carving)</h3>
                <p>
                    C'est ici que r√©side la valeur ajout√©e de l'expertise. SQLite utilise un m√©canisme de journalisation
                    appel√© <strong>Write-Ahead Log (WAL)</strong>. Les nouvelles donn√©es sont d'abord √©crites dans ce
                    fichier temporaire avant d'√™tre fusionn√©es.
                </p>
                <p>
                    Tant que cette fusion (appel√©e "Checkpoint") n'a pas eu lieu, le texte original persiste
                    physiquement sur le disque. En effectuant une <strong>analyse hexad√©cimale brute</strong> (Raw Hex
                    Dump) du fichier <code>msgstore.db-wal</code>, nous contournons la logique de base de donn√©es.
                </p>
                <p><strong>Le r√©sultat est sans appel : le message supprim√© est retrouv√© en clair.</strong></p>

                <img src="assets/img/blog/capture_ecran_5.png" alt="Editeur Hexad√©cimal HxD" class="project-img">
                <center>
                    <p class="img-caption">Figure 5 : L'analyse bas niveau du fichier WAL r√©v√®le la persistance des
                        donn√©es. Le message "CODE_BUNKER" est retrouv√© en clair.</p>
                </center>

                <h3>üåê 5. Exploitation Avanc√©e des M√©tadonn√©es</h3>
                <p>
                    L'analyse forensique ne s'arr√™te pas √† la r√©cup√©ration du texte. L'examen structurel des 266 tables
                    de la base de donn√©es a permis d'extraire des √©l√©ments de contexte critiques qui permettent de lier
                    les faits √† des individus et des lieux pr√©cis.
                </p>

                <h4>A. Attribution et Profilage (Table wa_contacts)</h4>
                <p>
                    Lier un identifiant technique √† une personne r√©elle est crucial. En analysant la table
                    <code>wa_contacts</code>, nous avons pu faire le lien entre le JID (Jabber ID) interne et le num√©ro
                    de t√©l√©phone r√©el.
                </p>
                <p>
                    Comme le montre la capture ci-dessous, le JID <code>237658...</code> est formellement identifi√©. De
                    plus, nous avons extrait le statut personnalis√© du suspect : <em>"L3 h4ck3r 13 plus n00b du
                        Tch4d"</em>, un √©l√©ment pr√©cieux pour le profilage psychologique.
                </p>
                <img src="assets/img/blog/capture_ecran_6.png" alt="Table wa_contacts" class="project-img">
                <center>
                    <p class="img-caption">Figure 6 : D√©sanonymisation du contact et r√©cup√©ration du statut via la table
                        wa_contacts.</p>
                </center>

                <h4>B. La Persistance des "Vue Unique" (ViewOnce)</h4>
                <p>
                    Contrairement √† la promesse de confidentialit√© totale, les m√©dias √©ph√©m√®res laissent des traces
                    durables. L'analyse de la table <code>message_media</code> r√©v√®le que WhatsApp conserve les
                    m√©tadonn√©es des fichiers m√™me apr√®s leur suppression de l'interface.
                </p>
                <p>
                    Nous avons identifi√© des chemins de fichiers explicites contenant <code>/ViewOnce/</code> (voir
                    ligne 1 et 2 de la capture). Les m√©tadonn√©es incluent la taille (794 Ko), le type MIME (video/mp4)
                    et la date d'envoi, prouvant l'existence et la nature de l'√©change multim√©dia.
                </p>
                <img src="assets/img/blog/capture_ecran_7.png" alt="Table message_media view once" class="project-img">
                <center>
                    <p class="img-caption">Figure 7 : Preuves de m√©dias "Vue Unique" (ViewOnce) persistantes dans la
                        base de donn√©es.</p>
                </center>

                <h4>C. G√©olocalisation Pr√©cise (Table message_location)</h4>
                <p>
                    L'√©l√©ment le plus incriminant se trouve dans la table <code>message_location</code>. Si le suspect a
                    partag√© sa position (m√™me bri√®vement), les coordonn√©es GPS brutes sont stock√©es.
                </p>
                <p>
                    Dans ce laboratoire, nous avons extrait les coordonn√©es suivantes : <strong>Latitude 12.1522594,
                        Longitude 15.0483844</strong>. Ces donn√©es confirment la pr√©sence du suspect dans une zone
                    pr√©cise de N'Djamena au moment des faits.
                </p>
                <img src="assets/img/blog/capture_ecran_8.png" alt="Table message_location GPS" class="project-img">
                <center>
                    <p class="img-caption">Figure 8 : Extraction de coordonn√©es GPS confirmant la localisation √†
                        N'Djamena.</p>
                </center>

                <h3>üìù Conclusion</h3>
                <p>
                    Cette d√©monstration technique souligne deux r√©alit√©s fondamentales pour la s√©curit√© nationale et la
                    justice :
                </p>
                <p>
                    Premi√®rement, <strong>la suppression est une illusion num√©rique</strong>. En informatique
                    forensique, "supprimer" signifie souvent "cacher" ou "marquer pour √©crasement futur", et non
                    "d√©truire instantan√©ment".
                </p>
                <p>
                    Deuxi√®mement, la puissance de l'acc√®s Root est ind√©niable. Une fois qu'un expert a un acc√®s physique
                    et Root √† un terminal, le chiffrement de l'application (au repos) ne suffit plus √† prot√©ger les
                    secrets. L'expertise forensique mobile n'est plus une option, c'est une n√©cessit√© strat√©gique.
                </p>

            </div>

            <div class="cta-buttons" style="margin-top: 3rem; justify-content: center;">
                <a href="index.html#contact" class="btn">Besoin d'une expertise ?</a>
                <a href="index.html#portfolio" class="btn btn-secondary">Voir d'autres labs</a>
            </div>
        </div>
    </section>

    <div id="footer-placeholder"></div>

    <script src="assets/js/components.js"></script>
    <script src="assets/js/main.js" defer></script>
</body>

</html>